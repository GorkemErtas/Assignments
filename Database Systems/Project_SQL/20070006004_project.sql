-- Name:...Görkem Ertaş
-- ID:...20070006004

CREATE SCHEMA SE2222_20070006004;
USE SE2222_20070006004;

DROP TABLE IF EXISTS AL;
-- AL table holds airlines name, country, budget.
CREATE TABLE AL (
ALNAME VARCHAR(30) PRIMARY KEY,
COUNTRY VARCHAR(20) NOT NULL,
BUDGET DECIMAL(10,2) NOT NULL);

INSERT INTO AL VALUES('TURKISH AIRLINES','TURKEY','20000000.00');
INSERT INTO AL VALUES('PEGASUS AIRLINES','TURKEY','10000000.00');
INSERT INTO AL VALUES('AMERICAN AIRLINES','UNITED STATES','60000000.00');
INSERT INTO AL VALUES('DELTA AIRLINES','UNITED STATES','50000000.00');
INSERT INTO AL VALUES('CHINA SOUTHERN AIRLINES','CHINA','40000000.00');


DROP TABLE IF EXISTS PL;
-- PL table holds plane code, capacity, maintenance budget.
CREATE TABLE PL (
PLCODE CHAR(5) PRIMARY KEY,
CAP INT NOT NULL,
MBUD DECIMAL(6,2) NOT NULL,
TCODE VARCHAR(3),
CONSTRAINT pl_tcode FOREIGN KEY(TCODE) REFERENCES TERM(TCODE));

INSERT INTO PL VALUES('A1234','150','2000.00','G1');
INSERT INTO PL VALUES('K3242','135','1000.00','H23');
INSERT INTO PL VALUES('E5436','158','2500.00','B45');
INSERT INTO PL VALUES('C5473','122','800.00','Y97');
INSERT INTO PL VALUES('Z8271','176','5000.00','U8');


DROP TABLE IF EXISTS TERM;
-- TERM table holds terminal code, location.
CREATE TABLE TERM (
TCODE VARCHAR(3) PRIMARY KEY,
LOC VARCHAR(10) NOT NULL);

INSERT INTO TERM VALUES('B45','EAST');
INSERT INTO TERM VALUES('G1','WEST');
INSERT INTO TERM VALUES('H23','EAST');
INSERT INTO TERM VALUES('U8','SOUTH');
INSERT INTO TERM VALUES('Y97','NORTH');


DROP TABLE IF EXISTS TICKET;
-- TICKET table holds ticket number, ticket type, fee.
CREATE TABLE TICKET (
TNO VARCHAR(6) PRIMARY KEY,
TTYPE VARCHAR(20) NOT NULL,
FEE DECIMAL(6,2) NOT NULL);

INSERT INTO TICKET VALUES('CFG324','ECONOMY','450');
INSERT INTO TICKET VALUES('DJF647','PREMIUM ECONOMY','750');
INSERT INTO TICKET VALUES('LDK950','FIRST','2000');
INSERT INTO TICKET VALUES('AED435','BUSINESS','1500');
INSERT INTO TICKET VALUES('MCN664','ECONOMY','500');


DROP TABLE IF EXISTS BOOK;
-- BOOK table holds booking number, departure area, destination area.
CREATE TABLE BOOK (
BOOKNO VARCHAR(6) PRIMARY KEY,
DEP VARCHAR(20) NOT NULL,
DEST VARCHAR(20) NOT NULL);

INSERT INTO BOOK VALUES('LSD315','ISTANBUL','ANKARA');
INSERT INTO BOOK VALUES('UTR834','NEW YORK','WASHINGTON');
INSERT INTO BOOK VALUES('DDR354','IZMIR','ANTALYA');
INSERT INTO BOOK VALUES('IKL999','PEKIN','VUHAN');
INSERT INTO BOOK VALUES('AFH553','LAS VEGAS','HOUSTON');


DROP TABLE IF EXISTS TIMELINE;
-- TIMELINE table holds flight day, departure time, arrival time.
CREATE TABLE TIMELINE (
FDAY VARCHAR(10) NOT NULL,
DEPT VARCHAR(10) NOT NULL,
ARRT VARCHAR(10) NOT NULL,
CONSTRAINT tl_pk PRIMARY KEY(FDAY,DEPT,ARRT));

INSERT INTO TIMELINE VALUES('SUNDAY','10.00 AM','12.00 AM');
INSERT INTO TIMELINE VALUES('TUESDAY','05.45 PM','08.05 PM');
INSERT INTO TIMELINE VALUES('THURSDAY','09.15 PM','11.30 PM');
INSERT INTO TIMELINE VALUES('SATURDAY','06.55 AM','07.30 AM');
INSERT INTO TIMELINE VALUES('TUESDAY','01.15 PM','03.00 PM');


DROP TABLE IF EXISTS PASS;
-- PASS table holds passenger number, name, phone number, email, terminal code, flight number, ticket number.
CREATE TABLE PASS (
PNO VARCHAR(10) PRIMARY KEY,
PNAME VARCHAR(20) NOT NULL,
PHNO VARCHAR(10) NOT NULL UNIQUE,
MAIL VARCHAR(30) NOT NULL UNIQUE,
TCODE VARCHAR(3),
FNO VARCHAR(8),
TNO VARCHAR(6),
CONSTRAINT pass_fk1 FOREIGN KEY(TCODE) REFERENCES TERM(TCODE),
CONSTRAINT pass_fk2 FOREIGN KEY(FNO) REFERENCES FLG(FNO),
CONSTRAINT pass_fk3 FOREIGN KEY(TNO) REFERENCES TICKET(TNO));

INSERT INTO PASS VALUES('WE432GG34D','ALEYNA','3823748929','ALEYNA123@OUTLOOK.COM','U8','DYFG4536','LDK950');
INSERT INTO PASS VALUES('FDS3432JN2','MAX','7438695837','MAX123@OUTLOOK.COM','B45','SDFL4589','AED435');
INSERT INTO PASS VALUES('JD3U4NF782','JACKIE CHAN','1236485047','JACKIE123@OUTLOOK.COM','Y97','OUMY0231','DJF647');
INSERT INTO PASS VALUES('D732MY64DH','MERT','8865499653','MERT123@OUTLOOK.COM','U8','DYFG4536','CFG324');
INSERT INTO PASS VALUES('C483K09T6F','JACK','7584997336','JACK123@OUTLOOK.COM','Y97','OUMY0231','MCN664');


DROP TABLE IF EXISTS FLG;
-- FLG table holds flight number, day, departure time, arrival time.
CREATE TABLE FLG (
FNO VARCHAR(8) PRIMARY KEY ,
FDAY VARCHAR(10),
DEPT VARCHAR(10),
ARRT VARCHAR(10),
CONSTRAINT flg_fk FOREIGN KEY(FDAY,DEPT,ARRT) REFERENCES TIMELINE(FDAY,DEPT,ARRT));

INSERT INTO FLG VALUES('DYFG4536','THURSDAY','09.15 PM','11.30 PM');
INSERT INTO FLG VALUES('DKFR3457','TUESDAY','01.15 PM','03.00 PM');
INSERT INTO FLG VALUES('SDFL4589','SUNDAY','10.00 AM','12.00 AM');
INSERT INTO FLG VALUES('CXNV3245','SATURDAY','06.55 AM','07.30 AM');
INSERT INTO FLG VALUES('OUMY0231','TUESDAY','05.45 PM','08.05 PM');


DROP TABLE IF EXISTS STF;
-- STF table holds staff id, name, phone number, work for, job, salary.
CREATE TABLE STF (
SID VARCHAR(6) PRIMARY KEY ,
SNAME VARCHAR(20) NOT NULL,
SPHNO VARCHAR(10) NOT NULL UNIQUE,
WFOR VARCHAR(30) NOT NULL,
JOB VARCHAR(20) NOT NULL,
SAL DECIMAL(7,2) NOT NULL);

INSERT INTO STF VALUES('432956','JOHN','3842905438','AMERICAN AIRLINES','PILOT','50000.00');
INSERT INTO STF VALUES('938490','MELEK','7384958869','TURKISH AIRLINES','HOSTESS','10000.00');
INSERT INTO STF VALUES('734995','ALPEREN','8827366478','TURKISH AIRLINES','CO-PILOT','30000.00');
INSERT INTO STF VALUES('444562','GÖRKEM','0972649367','PEGASUS AIRLINES','MANAGER','20000.00');
INSERT INTO STF VALUES('343785','YANG','2375846958','CHINA SOUTHERN AIRLINES','PILOT','45000.00');


-- Count staff numbers on airlines by countries. 
SELECT AL.COUNTRY, COUNT(*) AS AIRLINE_COUNT FROM AL JOIN STF ON AL.ALNAME = STF.WFOR GROUP BY AL.COUNTRY;
-- Retrieve the names of passengers who have booked flights departing from the 'EAST' terminal.
SELECT PNAME FROM PASS WHERE TCODE IN (SELECT TCODE FROM TERM WHERE LOC = 'EAST');
-- Multiply the current salary by 1.1 for pilots.
UPDATE STF SET SAL = SAL * 1.1 WHERE JOB = 'PILOT';
-- Remove bookings for flights from Istanbul to Ankara.
DELETE FROM BOOK WHERE DEP = 'ISTANBUL' AND DEST = 'ANKARA';
-- Select the airline name and calculates 10% of the budget for each airline as "TEN_PERCENT_BUDGET".
SELECT ALNAME, BUDGET * 0.1 AS TEN_PERCENT_BUDGET FROM AL;
